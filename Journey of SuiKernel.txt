If you managed to find and read this. I consider you as a kernel developer
Note: 
- I Use self-hosted runners. Configure it by yourself
- I recommend you to use the mainline / lts from Google, if you decided to use pure Linux kernel. Leave
- And to upstream, I recommend you to upstream from your original branch (mainline / lts)
- Don't ask AIs for the modification, some of them are incorrect and leading you to try and see
- Instead read the Kconfig file (You may ask AIs to find the Kconfig related to your modification)
- And add the CONFIG_ in the begining of your config modification
- Note: Sometimes you need to modify how the Kconfig works

# Get & SYNC Source
repo init -u https://android.googlesource.com/kernel/manifest -b common-android12-5.10
repo sync -c -j$(nproc --all)

# Up to GitHub to SuiKernel-Main Branch
cd common
git checkout -b suikernel-upstream | suikernel-main (In case you haven't make a new branch)
git remote set-url origin https://github.com/LoggingNewMemory/SuiKernel-android12-5.10
git remote -v (To Verify The Remote)
git branch -m suikernel-experimental | suikernel-main

git pull origin suikernel-upstream | suikernel-main (Just in case if you need to continue)

# Making Changes
git add .
git checkout suikernel-upstream | suikernel-main
git commit -m "Your Message"
git push -u origin suikernel-main

# To upstream
git remote add upstream https://android.googlesource.com/kernel/common
git fetch upstream refs/tags/android12-5.10.239_r00 (Example Tag | Find your tags here: https://android.googlesource.com/kernel/common/+refs)
git merge FETCH_HEAD
git push -u origin suikernel-upstream

If you need to see the changelog:
https://android-review.googlesource.com/q/project:kernel/common+branch:android12-5.10 (Android12-5.10)
https://android-review.googlesource.com/q/project:kernel/common+branch:android12-5.10-lts (Android12-5.10-lts)

# If you too lazy to manually change, you can do cherry pick my commit
git remote add yamada https://github.com/LoggingNewMemory/SuiKernel-android12-5.10
git fetch yamada
git cherry pick <my commit hash>

# If you want to find a kernel config flag 
grep -r "config SCHED_MC" .
inside your kernel source

Note: SCHED_MC replace it with your config flag

# If you want to add something to your install script
modify anykernel.sh (See https://github.com/LoggingNewMemory/SuiKernel-anykernel)
########################
# Setup SUSFS
########################
Fork KernelSU Next repo (Change it to your own name (Ex: SuiKernel-KernelSU-Next)
This tutorial assumes you use next branch (no changes)
Git clone your forked KernelSU Next repo (git clone [repo link])
Delete everything execpt kernel folder
Get my susfs.sh https://github.com/LoggingNewMemory/SuiKernel-KernelSU-Next/blob/next/susfs.sh
Run the susfs.sh inside your your forked repo 
Modify setup.sh inside your kernel folder (/kernel/setup.sh)

Change the
test -d "$GKI_ROOT/KernelSU-Next" || git clone https://github.com/KernelSU-Next/KernelSU-Next && echo "[+] Repository cloned."

To
test -d "$GKI_ROOT/KernelSU-Next" || git clone --depth 1 https://github.com/LoggingNewMemory/SuiKernel-KernelSU-Next KernelSU-Next && echo "[+] Repository cloned."

Note: https://github.com/LoggingNewMemory/SuiKernel-KernelSU-Next is just example, use your own KernelSU Next repo

########################
# Switch to LTO Thin (Unless your device is strong enough to build with full LTO)
########################
- arch/arm64/configs/gki_defconfig
CONFIG_LTO_CLANG_FULL=y replace CONFIG_LTO_CLANG_THIN=y

########################
# Patches of Xiaomi Garnet (Thanks: Goten)
########################
cherry pick this

https://github.com/LoggingNewMemory/SuiKernel-android12-5.10/compare/6acfb8ce2e8bb7d52d4c92b22b2a82fbe35d2659...97be0f361d658377705e90a635564ab733969dd7

########################
# Fixes Touchscreen (Thanks: Bintang)
########################
curl -s https://github.com/LoggingNewMemory/SuiKernel-Release/blob/main/Patches/FixTouch.patch | git am

########################
# Adding Schedhorizon
########################
Follow This
https://github.com/LoggingNewMemory/SuiKernel-android12-5.10/compare/cc08dc3bfd1f2eadc6edc7603ed6d01c365c3d15...d1a5000f1f6eb13044716b7bc759ca3aeae2f8bc
Then add "CONFIG_CPU_FREQ_GOV_SCHEDHORIZON=y" at the end of arch/arm64/configs/gki_defconfig

########################
# Using BBR (Default & Remove Cubic) - Okay, probably overkill but works (Revise needed)
########################
inside /net/ipv4/Kconfig

config TCP_CONG_CUBIC
modify from default y to default n

config DEFAULT_TCP_CONG
modify from default "cubic" to default "bbr"

then add

CONFIG_TCP_CONG_ADVANCED=y
CONFIG_TCP_CONG_BBR=y
CONFIG_TCP_CONG_BIC=n
CONFIG_TCP_CONG_WESTWOOD=n
CONFIG_TCP_CONG_HTCP=n
CONFIG_DEFAULT_BBR=y
CONFIG_DEFAULT_TCP_CONG="bbr"

at the end of arch/arm64/configs/gki_defconfig

########################
# Use BFQ 
########################
CONFIG_IOSCHED_BFQ=y
CONFIG_BFQ_GROUP_IOSCHED=y
CONFIG_MQ_IOSCHED_DEADLINE=y
CONFIG_MQ_IOSCHED_DEADLINE_CGROUP=y
CONFIG_MQ_IOSCHED_KYBER=y
CONFIG_DEFAULT_IOSCHED="bfq"

at the end of arch/arm64/configs/gki_defconfig

########################
# Use CAKE (Common Applications Kept Enhanced)
########################
inside net/sched/Kconfig

modify 
default DEFAULT_PFIFO_FAST to default DEFAULT_CAKE

add 
config DEFAULT_CAKE
		bool "Common Applications Kept Enhanced" if NET_SCH_CAKE

under 
config DEFAULT_SFQ
		bool "Stochastic Fair Queue" if NET_SCH_SFQ

add default "pfifo_fast" under default "sfq" if DEFAULT_SFQ

modify default "pfifo_fast" to default "cake"

add

CONFIG_NET_SCH_DEFAULT=y
CONFIG_NET_SCH_CAKE=y
CONFIG_DEFAULT_NET_SCH="cake"

at the end of arch/arm64/configs/gki_defconfig

see: https://github.com/LoggingNewMemory/SuiKernel-android12-5.10/compare/09a76308ce1abbf76c02590f22c080c9a1b08440...53bc6e3bde880ada85b3ece0b1699217805ca937

###########################
# Use None as I/O scheduler
Why? I focused on Minimal CPU Overhead
###########################
CONFIG_MQ_IOSCHED_DEADLINE=n
CONFIG_MQ_IOSCHED_DEADLINE_CGROUP=n
CONFIG_MQ_IOSCHED_KYBER=n

at the end of arch/arm64/configs/gki_defconfig

###########################
# 300 Hz 
(Actually I want to set 1000Hz, But it gonna consume a lot of power)
###########################
CONFIG_HZ_300=y

at the end of arch/arm64/configs/gki_defconfig

###########################
# Sched MC
###########################
CONFIG_SCHED_MC=y

at the end of arch/arm64/configs/gki_defconfig
